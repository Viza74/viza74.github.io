!function(e){function t(t){for(var n,r,l=t[0],s=t[1],c=t[2],p=0,h=[];p<l.length;p++)r=l[p],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&h.push(o[r][0]),o[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(u&&u(t);h.length;)h.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,l=1;l<a.length;l++){var s=a[l];0!==o[s]&&(n=!1)}n&&(i.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},o={2:0},i=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=s;i.push([328,0]),a()}({328:function(e,t,a){"use strict";a.r(t),a.d(t,"init",(function(){return z}));var n=a(10),o=a(18),i=a(77),r=a(26),l=a(323),s=a(16),c=a(34),u=a(36),p=(a(303),a(331),a(135)),h=(a(330),a(302),a(173)),d=a(94),f=a(126),m=a(324),g=a(166),w=a(325),b=a(110),v=a(60);let y,M=window.localStorage,I=null,k=null,x=null,P=null,_=!1,O=null,C=null,T=null;async function z(e){y=new Nanobar;const t=document.getElementById("renderCanvas");b.a.DefaultLogoUrl="assets/JADI_2020_logo.png",b.a.DefaultSpinnerUrl="assets/JADI_spinner.svg",O=new n.a(t),C=await async function(e){var t=new o.a(O);T=new i.a("Camera",-Math.PI/2,Math.PI/2,.01,r.g.Zero(),t),T.minZ=.1,T.attachControl(e,!0),T.inputs.attached.mousewheel.detachControl(e),T.panningDistanceLimit=0,T.panningAxis=r.g.Zero(),T.upperRadiusLimit=T.radius,T.lowerRadiusLimit=T.radius,I=h.a.CreateFullscreenUI("UI");let a=new d.a;a.color="White",a.fontSize=14,I.addControl(a),p.b.RegisterExtension("custom",(function(e){return new U(e)})),x=new u.a("currPoint",t),x.scaling.z=-1,P=new u.a("nextPoint",t),P.scaling.z=-1,t.addTransformNode(x);let n=M.getItem("lastPoint"),l=M.getItem("camAlpha"),c=M.getItem("camBeta");null==n&&(n="JADI_VR_ENERGY_01",l=T.alpha.toString(),c=T.beta.toString(),E(n,T.alpha,T.beta));k=n,T.alpha=parseFloat(l),T.beta=parseFloat(c),A(n,x,!1,t,I),_=!1,t.onPointerDown=async function(e,t){_||t.hit&&S(t.pickedMesh)},t.registerAfterRender((function(){v.a.update(),T.alpha=N(T.alpha),T.fov=f}));var f=1;return t.onPointerObservable.add((function(e){(f+=-5e-4*e.event.wheelDelta)<.3&&(f=.3),f>1.3&&(f=1.3)}),s.a.POINTERWHEEL),t}(t),window.addEventListener("resize",(function(){O.resize()})),O.runRenderLoop(()=>{C.render()})}function S(e){if(!_)switch(B(e,"type")){case"tourpoint":!async function(e){let t=e.position;t.z*=-1;let a=function(e,t){var a=new r.g,n=e.alpha,o=e.beta;e.position.subtractToRef(t,a),a.normalize(),n=0===a.x&&0===a.z?Math.PI/2:Math.acos(a.x/Math.sqrt(Math.pow(a.x,2)+Math.pow(a.z,2)));a.z<0&&(n=2*Math.PI-n);n=N(n);var i=Math.abs(n-e.alpha),l=Math.abs(n+2*Math.PI-e.alpha),s=Math.abs(n-2*Math.PI-e.alpha);s<=i&&s<=l?n-=2*Math.PI:l<=i&&l<=s&&(n+=2*Math.PI);return o=Math.PI/2,i=Math.max(Math.abs(n-e.alpha),Math.abs(o-e.beta)),i=Math.max(Math.min(5e3*i,1e3),500),{alpha:n,beta:o,time:i}}(T,t);n=T,o=a.alpha,i=a.beta,l=a.time,new v.a.Tween(n).to({alpha:o,beta:i},l).easing(v.a.Easing.Sinusoidal.InOut).start();var n,o,i,l;var s=B(e,"linkTo");if(null==s)return void console.error("'Tourpoint' type target without 'linkTo' attribute.");_=!0,k=s,E(s,T.alpha,T.beta),await A(s,P,!0,C,I),D(x,I,0,!0);var c=x.getChildren(e=>e.name.startsWith("dome_"))[0],u=P.getChildren(e=>e.name.startsWith("dome_"))[0];c.mesh.visibility=.99,c.mesh.material.alpha=1;var p={percent:0};p.percent=0,new v.a.Tween(p).to({percent:1},1e3).onUpdate(()=>{c.mesh.material.alpha=1-p.percent,u.mesh.material.alpha=p.percent}).delay(800).onComplete(()=>{var e=x;x=P,P=e,W(P,I);var t=x.getChildren(e=>e.name.startsWith("dome_"))[0];t.mesh.visibility=1,t.mesh.material.alpha=1,D(x,I,1,!0),_=!1}).start()}(e);break;case"info":case"interact":case"quiz":var t=B(e,"linkUrl");null!=t&&(E(k,T.alpha,T.beta),window.open(t,"_self"))}}function E(e,t,a){M.setItem("lastPoint",e),t=t.toString(),M.setItem("camAlpha",t),a=a.toString(),M.setItem("camBeta",a)}async function A(e,t,a,n,o){W(t,o);var i=(await c.a.LoadAssetContainerAsync("tour_points/",e+".glb",n,e=>{console.log(e.loaded,e.total,e.loaded/e.total),y.go(e.loaded/e.total*100)})).getNodes();for(var r of(console.log("Imported",i.length,"meshes."),i))if("__root__"!=r.name&&"Camera"!=r.name){if(null!=r.getTotalVertices){var s=r;n.addMesh(s),s.isVisible=!1}else n.addTransformNode(r);if(r.parent=t,null!=r.metadata){var u=r.metadata.customprops;if(null!=u){j(r,a?0:1,o);for(const e in u)if(u.hasOwnProperty(e)){const t=u[e];console.log(`   ${e}: ${t}`)}}}}var p=new l.a("dome_"+e,"tour_points/"+e+".jpg",{resolution:32,size:100,useDirectMapping:!1},n);p.parent=t,p.mesh.isPickable=!1,p.mesh.visibility=.99,p.mesh.material.alpha=a?0:1,console.log("Loading done.")}function D(e,t,a,n){var o=t.getDescendants(!0);for(let e=0;e<o.length;e++){const t=o[e];null!=t.name&&t.name.indexOf("_line")>=0&&1==a||new v.a.Tween(t).to({alpha:a},1e3).start()}}function W(e,t,a){var n=e.getChildren(),o=t.getDescendants(!0);for(let t=0;t<o.length;t++){const a=o[t];null!=a.linkedMesh&&a.linkedMesh.isDescendantOf(e)&&a.dispose()}if(n.length>0)for(let e=0;e<n.length;e++){const t=n[e];a&&t.name.startsWith("dome_")||t.dispose()}}function j(e,t,a){let n=B(e,"type"),o=null;switch(n){case"info":o=f.a.CreateImageOnlyButton(e.name+"_icon","assets/info-solid.svg");break;case"tourpoint":o=f.a.CreateImageOnlyButton(e.name+"_icon","assets/shoe-prints-solid.svg");break;case"interact":o=f.a.CreateImageOnlyButton(e.name+"_icon","assets/gamepad-solid.svg");break;case"quiz":o=f.a.CreateImageOnlyButton(e.name+"_icon","assets/quiz-solid.svg");break;default:return void console.warn("Unknown hotspot type '"+n+"', skipping.")}o.thickness=0,o.alpha=t,o.width="60px",o.height="60px",new v.a.Tween(o).to({scaleX:1.1,scaleY:1.1},600).easing(v.a.Easing.Sinusoidal.InOut).repeat(1/0).yoyo(!0).start();let i=function(e,t,a){let n=new d.a(e.name+"_tooltiptext");var o=B(e,"tooltip");null!=o?n.text=o:"tourpoint"==B(e,"type")?n.text="Move here":n.text="Empty tooltip";n.color="White",n.fontSize=14;let i=a.getContext();i.font="14px arial";var r=i.measureText(n.text).width,l=new g.a(e.name+"_rectbg");return l.clipChildren=!1,l.clipContent=!1,l.thickness=0,l.background="black",l.alpha=.5,l.width=r+40+"px",l.height="40px",a.addControl(l),l.addControl(n),l.linkWithMesh(e),l}(e,0,a);i.scaleX=i.scaleY=0;var r=new m.a(e.name+"_line");r.color="White",r.alpha=0,r.lineWidth=4,r.dash=[4,4],r.y2=20,r.linkOffsetY=-30,a.addControl(r),r.linkWithMesh(e),r.connectedControl=i;var l=new w.a(e.name+"_dot");l.width="10px",l.height="10px",l.thickness=0,l.background="white",l.top=20,i.addControl(l),a.addControl(o),o.linkWithMesh(e),o.pointerEnterAnimation=()=>{_||new v.a.Tween(i).to({alpha:1,scaleX:1,scaleY:1,linkOffsetYInPixels:20*(Math.random()-.5)-80,linkOffsetXInPixels:40*(Math.random()-.5)},600).onUpdate(()=>{r.alpha=i.alpha}).easing(v.a.Easing.Back.Out).start()},o.pointerOutAnimation=()=>{_||new v.a.Tween(i).to({alpha:0,scaleX:0,scaleY:0,linkOffsetYInPixels:0,linkOffsetXInPixels:0},600).onUpdate(()=>{r.alpha=i.alpha}).easing(v.a.Easing.Back.In).start()},o.onPointerUpObservable.add((function(){S(o.linkedMesh)}))}function N(e){for(;e>2*Math.PI;)e-=2*Math.PI;for(;e<0;)e+=2*Math.PI;return e}function U(e){this.name="custom",this.enabled=!0,this.loadNodeAsync=function(t,a,n){return e.loadNodeAsync(t,a,(function(e){a.extras&&Object.assign(e.metadata,{customprops:a.extras})}))},this.dispose=function(){}}function B(e,t){if(null==e.metadata)return console.log("   No metadata found, skipping."),null;var a=e.metadata.customprops;if(null==a)return console.log("   No customprops, skipping."),null;if(null==t||""==t)return a;for(const e in a)if(a.hasOwnProperty(e)&&e==t){return a[e]}}window.init=z}});