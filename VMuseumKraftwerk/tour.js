!function(e){function t(t){for(var n,r,l=t[0],s=t[1],u=t[2],p=0,h=[];p<l.length;p++)r=l[p],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&h.push(o[r][0]),o[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(c&&c(t);h.length;)h.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,l=1;l<a.length;l++){var s=a[l];0!==o[s]&&(n=!1)}n&&(i.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},o={2:0},i=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var c=s;i.push([328,0]),a()}({328:function(e,t,a){"use strict";a.r(t),a.d(t,"init",(function(){return A}));var n=a(10),o=a(18),i=a(77),r=a(26),l=a(323),s=a(16),u=a(34),c=a(36),p=a(32),h=a(186),d=(a(303),a(331),a(135)),f=(a(330),a(302),a(173)),m=a(94),g=a(126),w=a(324),v=a(166),b=a(325),y=a(110),M=a(60);let I,x=window.localStorage,P=null,k=null,_=null,O=null,C=!1,T=null,z=null,S=null,E=null;async function A(e){I=new Nanobar;const t=document.getElementById("renderCanvas");y.a.DefaultLogoUrl="assets/JADI_2020_logo.png",y.a.DefaultSpinnerUrl="assets/JADI_spinner.svg",T=new n.a(t),z=await async function(e){var t=new o.a(T);S=new i.a("Camera",-Math.PI/2,Math.PI/2,.01,r.g.Zero(),t),S.minZ=.1,S.attachControl(e,!0),S.inputs.attached.mousewheel.detachControl(e),S.panningDistanceLimit=0,S.panningAxis=r.g.Zero(),S.upperRadiusLimit=S.radius,S.lowerRadiusLimit=S.radius,P=f.a.CreateFullscreenUI("UI");let a=new m.a;a.color="White",a.fontSize=14,P.addControl(a),d.b.RegisterExtension("custom",(function(e){return new R(e)})),_=new c.a("currPoint",t),_.scaling.z=-1,O=new c.a("nextPoint",t),O.scaling.z=-1,t.addTransformNode(_);let n=x.getItem("lastPoint"),l=x.getItem("camAlpha"),u=x.getItem("camBeta");null==n&&(n="JADI_VR_ENERGY_01",l=S.alpha.toString(),u=S.beta.toString(),U(n,S.alpha,S.beta));k=n,S.alpha=parseFloat(l),S.beta=parseFloat(u),W(n,_,!1,t,P),C=!1,t.onPointerDown=async function(e,t){C||t.hit},t.registerAfterRender((function(){M.a.update(),S.alpha=L(S.alpha),S.fov=p}));var p=1;return t.onPointerObservable.add((function(e){(p+=-5e-4*e.event.wheelDelta)<.3&&(p=.3),p>1.3&&(p=1.3)}),s.a.POINTERWHEEL),t}(t),window.addEventListener("resize",(function(){T.resize()})),T.runRenderLoop(()=>{z.render()})}function D(e){if(!C)switch(Y(e,"type")){case"tourpoint":!async function(e){let t=e.position;t.z*=-1;let a=function(e,t){var a=new r.g,n=e.alpha,o=e.beta;e.position.subtractToRef(t,a),a.normalize(),n=0===a.x&&0===a.z?Math.PI/2:Math.acos(a.x/Math.sqrt(Math.pow(a.x,2)+Math.pow(a.z,2)));a.z<0&&(n=2*Math.PI-n);n=L(n);var i=Math.abs(n-e.alpha),l=Math.abs(n+2*Math.PI-e.alpha),s=Math.abs(n-2*Math.PI-e.alpha);s<=i&&s<=l?n-=2*Math.PI:l<=i&&l<=s&&(n+=2*Math.PI);return o=Math.PI/2,i=Math.max(Math.abs(n-e.alpha),Math.abs(o-e.beta)),i=Math.max(Math.min(5e3*i,1e3),500),{alpha:n,beta:o,time:i}}(S,t);n=S,o=a.alpha,i=a.beta,l=a.time,new M.a.Tween(n).to({alpha:o,beta:i},l).easing(M.a.Easing.Sinusoidal.InOut).start();var n,o,i,l;var s=Y(e,"linkTo");if(null==s)return void console.error("'Tourpoint' type target without 'linkTo' attribute.");C=!0,k=s,U(s,S.alpha,S.beta),await W(s,O,!0,z,P),j(_,P,0,!0);var u=_.getChildren(e=>e.name.startsWith("dome_"))[0],c=O.getChildren(e=>e.name.startsWith("dome_"))[0];u.mesh.visibility=.99,u.mesh.material.alpha=1;var p={percent:0};p.percent=0,new M.a.Tween(p).to({percent:1},1e3).onUpdate(()=>{u.mesh.material.alpha=1-p.percent,c.mesh.material.alpha=p.percent}).delay(800).onComplete(()=>{var e=_;_=O,O=e,N(O,P);var t=_.getChildren(e=>e.name.startsWith("dome_"))[0];t.mesh.visibility=1,t.mesh.material.alpha=1,j(_,P,1,!0),C=!1}).start()}(e);break;case"info":case"interact":case"quiz":var t=Y(e,"linkUrl");null!=t&&(U(k,S.alpha,S.beta),window.open(t,"_self"))}}function U(e,t,a){x.setItem("lastPoint",e),t=t.toString(),x.setItem("camAlpha",t),a=a.toString(),x.setItem("camBeta",a)}async function W(e,t,a,n,o){N(t,o);var i=(await u.a.LoadAssetContainerAsync("tour_points/",e+".glb",n,e=>{console.log(e.loaded,e.total,e.loaded/e.total),I.go(e.loaded/e.total*100)})).getNodes();for(var s of(console.log("Imported",i.length,"meshes."),i))if("__root__"!=s.name&&"Camera"!=s.name){if(null!=s.getTotalVertices){var c=s;if(n.addMesh(c),"video"==Y(c,"type")){var d=new p.a("mat",n),f=Y(c,"videoUrl");E=new h.a("video",f,n,!0,!0),E.video.volume=0,d.diffuseTexture=E,d.emissiveColor=new r.g(1,1,1),c.material=d,n.onPointerUp=function(){E.video.play(),E.video.volume=0}}else c.isVisible=!1}else n.addTransformNode(s);if(s.parent=t,null!=s.metadata){var m=s.metadata.customprops;if(null!=m){B(s,a?0:1,o);for(const e in m)if(m.hasOwnProperty(e)){const t=m[e];console.log(`   ${e}: ${t}`)}}}}var g=new l.a("dome_"+e,"tour_points/"+e+".jpg",{resolution:32,size:100,useDirectMapping:!1},n);g.parent=t,g.mesh.isPickable=!1,g.mesh.visibility=.99,g.mesh.material.alpha=a?0:1,console.log("Loading done.")}function j(e,t,a,n){var o=t.getDescendants(!0);for(let e=0;e<o.length;e++){const t=o[e];null!=t.name&&t.name.indexOf("_line")>=0&&1==a||new M.a.Tween(t).to({alpha:a},1e3).start()}}function N(e,t,a){var n=e.getChildren(),o=t.getDescendants(!0);for(let t=0;t<o.length;t++){const a=o[t];null!=a.linkedMesh&&a.linkedMesh.isDescendantOf(e)&&a.dispose()}if(n.length>0)for(let e=0;e<n.length;e++){const t=n[e];a&&t.name.startsWith("dome_")||t.dispose()}}function B(e,t,a){let n=Y(e,"type"),o=null;switch(n){case"info":o=g.a.CreateImageOnlyButton(e.name+"_icon","assets/info-solid.svg");break;case"tourpoint":o=g.a.CreateImageOnlyButton(e.name+"_icon","assets/shoe-prints-solid.svg");break;case"interact":o=g.a.CreateImageOnlyButton(e.name+"_icon","assets/gamepad-solid.svg");break;case"quiz":o=g.a.CreateImageOnlyButton(e.name+"_icon","assets/quiz-solid.svg");break;default:return void console.warn("Unknown hotspot type '"+n+"', skipping.")}o.thickness=0,o.alpha=t,o.width="60px",o.height="60px",new M.a.Tween(o).to({scaleX:1.1,scaleY:1.1},600).easing(M.a.Easing.Sinusoidal.InOut).repeat(1/0).yoyo(!0).start();let i=function(e,t,a){let n=new m.a(e.name+"_tooltiptext");var o=Y(e,"tooltip");null!=o?n.text=o:"tourpoint"==Y(e,"type")?n.text="Move here":n.text="Empty tooltip";n.color="White",n.fontSize=14;let i=a.getContext();i.font="14px arial";var r=i.measureText(n.text).width,l=new v.a(e.name+"_rectbg");return l.clipChildren=!1,l.clipContent=!1,l.thickness=0,l.background="black",l.alpha=.5,l.width=r+40+"px",l.height="40px",a.addControl(l),l.addControl(n),l.linkWithMesh(e),l}(e,0,a);i.scaleX=i.scaleY=0;var r=new w.a(e.name+"_line");r.color="White",r.alpha=0,r.lineWidth=4,r.dash=[4,4],r.y2=20,r.linkOffsetY=-30,a.addControl(r),r.linkWithMesh(e),r.connectedControl=i;var l=new b.a(e.name+"_dot");l.width="10px",l.height="10px",l.thickness=0,l.background="white",l.top=20,i.addControl(l),a.addControl(o),o.linkWithMesh(e),o.pointerEnterAnimation=()=>{C||new M.a.Tween(i).to({alpha:1,scaleX:1,scaleY:1,linkOffsetYInPixels:20*(Math.random()-.5)-80,linkOffsetXInPixels:40*(Math.random()-.5)},600).onUpdate(()=>{r.alpha=i.alpha}).easing(M.a.Easing.Back.Out).start()},o.pointerOutAnimation=()=>{C||new M.a.Tween(i).to({alpha:0,scaleX:0,scaleY:0,linkOffsetYInPixels:0,linkOffsetXInPixels:0},600).onUpdate(()=>{r.alpha=i.alpha}).easing(M.a.Easing.Back.In).start()},o.onPointerUpObservable.add((function(){D(o.linkedMesh)}))}function L(e){for(;e>2*Math.PI;)e-=2*Math.PI;for(;e<0;)e+=2*Math.PI;return e}function R(e){this.name="custom",this.enabled=!0,this.loadNodeAsync=function(t,a,n){return e.loadNodeAsync(t,a,(function(e){a.extras&&Object.assign(e.metadata,{customprops:a.extras})}))},this.dispose=function(){}}function Y(e,t){if(null==e.metadata)return console.log("   No metadata found, skipping."),null;var a=e.metadata.customprops;if(null==a)return console.log("   No customprops, skipping."),null;if(null==t||""==t)return a;for(const e in a)if(a.hasOwnProperty(e)&&e==t){return a[e]}}window.init=A}});